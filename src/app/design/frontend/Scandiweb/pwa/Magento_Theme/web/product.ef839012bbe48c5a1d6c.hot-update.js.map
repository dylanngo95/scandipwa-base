{"version":3,"sources":["webpack:///./src/app/component/ProductReviews/ProductReviews.component.js"],"names":["ProductReviews","product","props","REVIEW_POPUP_ID","block","elem","showPopup","__","percent","reviewCount","rating_summary","review_summary","review_count","STARS_COUNT","PERCENT","parseFloat","toFixed","renderNoRating","renderRatingSchema","reviewSchemaObject","itemType","itemProp","itemScope","renderRatingData","renderButton","areDetailsLoaded","heading","renderSummary","renderList","renderPopup","Object","defineProperty","_ProductReviews","value","ProductType","isRequired","PropTypes","func","bool"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;AAWA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;;;;AACO,IAAMA,eAAb;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,kCAWkB;AAAA,UACFC,OADE,GACU,KAAKC,KADf,CACFD,OADE;AAGV;AAAA;AAAA,yBACK,8CADL;AAEM,YAAE,EAAGE,sEAFX;AAGM,aAAG,EAAG;AAAEC,iBAAK,EAAE,gBAAT;AAA2BC,gBAAI,EAAE;AAAjC;AAHZ;AAAA;AAAA,yBAKS,0DALT;AAK2B,iBAAO,EAAGJ;AALrC;AAAA;AAQH;AAtBL;AAAA;AAAA,mCAwBmB;AAAA,UACHK,SADG,GACW,KAAKJ,KADhB,CACHI,SADG;AAGX;AAAA;AAAA;AAEM,eAAK,EAAC,gBAFZ;AAGM,cAAI,EAAC,QAHX;AAIM,aAAG,EAAG;AAAEF,iBAAK,EAAE;AAAT,WAJZ;AAKM,iBAAO,EAAGE;AALhB,WAOUC,EAAE,CAAC,oBAAD,CAPZ;AAAA;AAUH;AArCL;AAAA;AAAA,qCAuCqB;AACb;AAAA;AAAA,oCAEUA,EAAE,CAAC,oEAAD,CAFZ;AAAA;AAKH;AA7CL;AAAA;AAAA,uCA+CuBC,OA/CvB,EA+CgCC,WA/ChC,EA+C6C;AACrC;AAAA;AAAA;AAAA;AAAA;AAEc,kBAAQ,EAAC,aAFvB;AAEqC,iBAAO,EAAGD;AAF/C;AAAA;AAAA;AAGc,kBAAQ,EAAC,aAHvB;AAGqC,iBAAO,EAAG;AAH/C;AAAA;AAAA;AAIc,kBAAQ,EAAC,YAJvB;AAIoC,iBAAO,EAAG;AAJ9C;AAAA;AAAA;AAKc,kBAAQ,EAAC,aALvB;AAKqC,iBAAO,EAAGC;AAL/C;AAAA;AAQH;AAxDL;AAAA;AAAA,uCA0DuB;AAAA;;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,UAAIC,cAAc,0BAAG,KAAKR,KAAL,CAAWD,OAAd,iFAAG,oBAAoBU,cAAvB,0DAAG,sBAAoCD,cAAzD;AACA,UAAIE,YAAY,2BAAG,KAAKV,KAAL,CAAWD,OAAd,kFAAG,qBAAoBU,cAAvB,0DAAG,sBAAoCC,YAAvD;AAEA,UAAMC,WAAW,GAAG,CAApB;AACA,UAAMC,OAAO,GAAG,GAAhB,CAde,CAgBf;;AACA,UAAMN,OAAO,GAAGO,UAAU,CAACF,WAAW,IAAIH,cAAc,IAAI,CAAtB,CAAX,GAAsCI,OAAvC,CAAV,CAA0DE,OAA1D,CAAkE,CAAlE,CAAhB;;AAEA,UAAI,CAACJ,YAAL,EAAmB;AACf,eAAO,KAAKK,cAAL,EAAP;AACH;;AAED;AAAA;AAAA,+CAEU,KAAKC,kBAAL,CAAwBR,cAAxB,EAAwCE,YAAxC,CAFV;AAAA;AAAA,yBAGS,4DAHT;AAIU,aAAG,EAAG;AAAER,iBAAK,EAAE,gBAAT;AAA2BC,gBAAI,EAAE;AAAjC,WAJhB;AAKU,iBAAO,EAAGK;AALpB;AAAA;AAAA;AAOW,eAAK,EAAC,gBAPjB;AAOkC,cAAI,EAAC;AAPvC,WAQcF,OARd;AAAA;AAAA,uCASoBD,EAAE,CAAC,YAAD,EAAeK,YAAY,IAAI,CAA/B,CATtB;AAAA;AAaH;AA9FL;AAAA;AAAA,oCAgGoB;AAAA;;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,UAAIA,YAAY,2BAAG,KAAKV,KAAL,CAAWD,OAAd,kFAAG,qBAAoBU,cAAvB,0DAAG,sBAAoCC,YAAvD;AAEA,UAAMO,kBAAkB,GAAGP,YAAY,GACjC;AACEQ,gBAAQ,EAAE,mCADZ;AAEEC,gBAAQ,EAAE,iBAFZ;AAGEC,iBAAS,EAAE;AAHb,OADiC,GAK/B,EALR;AAOA;AAAA;AAAA;AAEM,eAAK,EAAC,gBAFZ;AAGM,cAAI,EAAC;AAHX,WAIWH,kBAJX;AAAA;AAAA;AAMY,eAAK,EAAC,gBANlB;AAMmC,cAAI,EAAC;AANxC,WAOcZ,EAAE,CAAC,kBAAD,CAPhB,GASU,KAAKgB,gBAAL,EATV,EAUU,KAAKC,YAAL,EAVV;AAAA;AAaH;AA/HL;AAAA;AAAA,iCAiIiB;AAAA,UACDvB,OADC,GACW,KAAKC,KADhB,CACDD,OADC;AAGT;AAAA;AAAA,yBACK,0DADL;AAEM,iBAAO,EAAGA;AAFhB;AAAA;AAKH;AAzIL;AAAA;AAAA,6BA2Ia;AAAA;;AAAA,wBAID,KAAKC,KAJJ;AAAA,UAEDD,OAFC,eAEDA,OAFC;AAAA,UAGDwB,gBAHC,eAGDA,gBAHC,EAML;AACA;AACA;;AACA,UAAIb,YAAY,2BAAG,KAAKV,KAAL,CAAWD,OAAd,kFAAG,qBAAoBU,cAAvB,0DAAG,sBAAoCC,YAAvD;AAEA,UAAMc,OAAO,GAAGD,gBAAgB,GAC1BlB,EAAE,CAAC,sBAAD,EAAyBK,YAAY,IAAI,GAAzC,CADwB,GAE1B,EAFN;AAIA;AAAA;AAAA,yBACK,uDADL;AAEM,eAAK,EAAC,iBAFZ;AAGM,aAAG,EAAG;AAAER,iBAAK,EAAE;AAAT,WAHZ;AAIM,oBAAU,EAAG;AAAEA,iBAAK,EAAE,gBAAT;AAA2BC,gBAAI,EAAE;AAAjC;AAJnB;AAAA;AAAA,yBAMS,0DANT;AAOU,aAAG,EAAG;AAAED,iBAAK,EAAE,gBAAT;AAA2BC,gBAAI,EAAE;AAAjC,WAPhB;AAQU,iBAAO,EAAGqB;AARpB,WAUc,KAAKC,aAAL,EAVd,EAWc,KAAKC,UAAL,EAXd,EAYc,KAAKC,WAAL,EAZd;AAAA;AAgBH;AA1KL;;AAAA;AAAA;AA3BAC,MAAM,CAACC,cAAP,CAAsBC,eAAtB,EAAuC,MAAvC,EAA+C;AAAEC,OAAK,EAAE;AAAT,CAA/C;;;;gBA2BajC,c,eACU;AACfC,SAAO,EAAEiC,6DAAW,CAACC,UADN;AAEf7B,WAAS,EAAE8B,iDAAS,CAACC,IAAV,CAAeF,UAFX;AAGfV,kBAAgB,EAAEW,iDAAS,CAACE;AAHb,C;;gBADVtC,c,kBAOa;AAClByB,kBAAgB,EAAE;AADA,C;;AAsKXzB,6EAAf,E","file":"product.ef839012bbe48c5a1d6c.hot-update.js","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport ContentWrapper from 'Component/ContentWrapper';\nimport ExpandableContent from 'Component/ExpandableContent';\nimport Popup from 'Component/Popup';\nimport ProductReviewForm from 'Component/ProductReviewForm';\nimport ProductReviewList from 'Component/ProductReviewList';\nimport ProductReviewRating from 'Component/ProductReviewRating';\nimport { ProductType } from 'Type/ProductList';\n\nimport { REVIEW_POPUP_ID } from './ProductReviews.config';\n\nimport './ProductReviews.style';\n\n/** @namespace Component/ProductReviews/Component */\nexport class ProductReviews extends PureComponent {\n    static propTypes = {\n        product: ProductType.isRequired,\n        showPopup: PropTypes.func.isRequired,\n        areDetailsLoaded: PropTypes.bool\n    };\n\n    static defaultProps = {\n        areDetailsLoaded: false\n    };\n\n    renderPopup() {\n        const { product } = this.props;\n\n        return (\n            <Popup\n              id={ REVIEW_POPUP_ID }\n              mix={ { block: 'ProductReviews', elem: 'Popup' } }\n            >\n                <ProductReviewForm product={ product } />\n            </Popup>\n        );\n    }\n\n    renderButton() {\n        const { showPopup } = this.props;\n\n        return (\n            <button\n              block=\"ProductReviews\"\n              elem=\"Button\"\n              mix={ { block: 'Button' } }\n              onClick={ showPopup }\n            >\n                { __('Write a new review') }\n            </button>\n        );\n    }\n\n    renderNoRating() {\n        return (\n            <p>\n                { __('There are no reviews yet! Click button on the right to submit one!') }\n            </p>\n        );\n    }\n\n    renderRatingSchema(percent, reviewCount) {\n        return (\n            <>\n                <meta itemProp=\"ratingValue\" content={ percent } />\n                <meta itemProp=\"worstRating\" content={ 0 } />\n                <meta itemProp=\"bestRating\" content={ 100 } />\n                <meta itemProp=\"reviewCount\" content={ reviewCount } />\n            </>\n        );\n    }\n\n    renderRatingData() {\n        // const {\n        //     product: {\n        //         review_summary: {\n        //             rating_summary,\n        //             review_count\n        //         } = {}\n        //     }\n        // } = this.props;\n\n        let rating_summary = this.props.product?.review_summary?.rating_summary;\n        let review_count = this.props.product?.review_summary?.review_count;\n\n        const STARS_COUNT = 5;\n        const PERCENT = 100;\n\n        // eslint-disable-next-line no-mixed-operators\n        const percent = parseFloat(STARS_COUNT * (rating_summary || 0) / PERCENT).toFixed(2);\n\n        if (!review_count) {\n            return this.renderNoRating();\n        }\n\n        return (\n            <>\n                { this.renderRatingSchema(rating_summary, review_count) }\n                <ProductReviewRating\n                  mix={ { block: 'ProductReviews', elem: 'SummaryRating' } }\n                  summary={ rating_summary }\n                />\n                <p block=\"ProductReviews\" elem=\"SummaryDetails\">\n                    { percent }\n                    <span>{ __('%s reviews', review_count || 0) }</span>\n                </p>\n            </>\n        );\n    }\n\n    renderSummary() {\n        // const {\n        //     product: {\n        //         review_summary: {\n        //             review_count\n        //         } = {}\n        //     }\n        // } = this.props;\n\n        let review_count = this.props.product?.review_summary?.review_count;\n\n        const reviewSchemaObject = review_count\n            ? {\n                itemType: 'http://schema.org/AggregateRating',\n                itemProp: 'aggregateRating',\n                itemScope: true\n            } : {};\n\n        return (\n            <div\n              block=\"ProductReviews\"\n              elem=\"Summary\"\n              { ...reviewSchemaObject }\n            >\n                <h3 block=\"ProductReviews\" elem=\"Title\">\n                    { __('Customer reviews') }\n                </h3>\n                { this.renderRatingData() }\n                { this.renderButton() }\n            </div>\n        );\n    }\n\n    renderList() {\n        const { product } = this.props;\n\n        return (\n            <ProductReviewList\n              product={ product }\n            />\n        );\n    }\n\n    render() {\n        const {\n            product,\n            areDetailsLoaded\n        } = this.props;\n\n        // const {\n        //     review_summary: { review_count } = {}\n        // } = product;\n        let review_count = this.props.product?.review_summary?.review_count;\n\n        const heading = areDetailsLoaded\n            ? __('Product reviews (%s)', review_count || '0')\n            : '';\n\n        return (\n            <ContentWrapper\n              label=\"Product reviews\"\n              mix={ { block: 'ProductReviews' } }\n              wrapperMix={ { block: 'ProductReviews', elem: 'Wrapper' } }\n            >\n                <ExpandableContent\n                  mix={ { block: 'ProductReviews', elem: 'Content' } }\n                  heading={ heading }\n                >\n                    { this.renderSummary() }\n                    { this.renderList() }\n                    { this.renderPopup() }\n                </ExpandableContent>\n            </ContentWrapper>\n        );\n    }\n}\n\nexport default ProductReviews;\n"],"sourceRoot":""}